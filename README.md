
# 🧪 MixUp_team4 : Grammar Error Correction Promptathon 

본 레포지토리는 Grammar Error Correction Promptathon  실험을 재현하고 확장하기 위한 코드 및 가이드를 제공합니다.


## 📌 프로젝트 개요

* **목표**: Solar Pro API를 활용하여 프롬프트 만으로 한국어 맞춤법 교정 성능을 개선한다. 
* **접근 전략**:
  1. System Prompt에서 role 부여
  2. 반복적인 오류 유형화 & 유형별 대응 전략 수립 -> Few-shot
  3. Few-shot을 system prompt에 포함시키지 않고, user, assistant 멀티턴인 것 처럼 작성해서 간결하고 출력 형식도 지킬 수 있게 함. 
 
 
* **주요 실험 내용**:

  * Many-shot 학습 기반 프롬프트 설계
    다수의 LLM이 실수하기 좋은 예제에 대한 User-Assistant 구조의 turn 설계는 model의 기대 output 형식을 간접적으로 압박하며 모델이 특이 케이스에 대한 추론과 단기 지식을 얻을 수 있게 해준다. 
  * 실험 결과 분석을 통해 시스템 메시지 반복 수정
    LLM의 역량을 극대화 하는 측면에서 단순히 인간 친화적인 Rule 정리 방식보다 경험적이고 직관적인 지시사항이 더 성능이 좋음.
  * RAG -> 기각
    RAG를 통해 줄 수 있는 예시는 직접 작성하고 정리한 예시보다 못함. 임베딩 기반 유사도 등의 기법으로 유사한 단어의 문장을 찾아내긴 쉽지만 비슷한 맞춤법 케이스를 제공하는 것은 어려움. 그리고 획일화된 개수의 품질 보장이 안되는 RAG input은 오히려 성능을 하락 시키고 헷갈리게 만들 수 있음.
  + CoT -> 기각
    LLM에 사고를 강요하는 것은 어려움. solar-pro는 추론 모델이 아니므로 사고를 유도하는 것의 결과가 추론모델에 비해 항상 고품질의 결과를 내보이는 것은 아님. 오히려 모델의 학습데이터 기반의 모델 자체 역량을 바라는 것이 맞춤법 교정 과정을 단계적으로 요구하는 것 보다 효율적이라는 것을 실험적으로도 검증함. 일반적으로 CoT가 효율적인 것은 태스크가 단위 태스크로 효율적으로 쪼개지는 것이지만 맞춤법 교정은 순서가 존재하는 태스크가 아니라 다양한 범주가 있는 수평적 태스크 이므로 배제함.
  + Multi-API call
    단 3번의 API 호출로는 실질적인 태스크 분할이나 검증 과정을 거치기 어려우며, 이는 실험적으로도 확인가능했다. 그에 비해 추론 자원의 증가 문제와 'test.py'의 err_sentence는 무조건 교정할 부분이 있으나 1차 교정 문장을 2차적으로 검증할 때는 교정할 부분이 없을 수도 있다는 점에서 오는 과교정, 불안정성 문제탓에 단일 API call로 구성함.
  + 한글 프롬프트/영어 프롬프트
    Solar는 원래 영어모델이었던 만큼 영어에 대한 instruction 이해도가 높긴 할 것이라 생각했다. 하지만 solar-pro에서 한국어 이해도도 높다는 점, 태스크가 엄밀한 한국어 핸들링을 요구한다는 점, 맞춤법 관련단어가 번역되었을 때 제대로된 의미를 갖지 못하니 어차피 규칙에서 한글이 포함된다는 점에서 섞어서 사용하기 보다 한글 단일로 구성하는 것이 좋다는 결론을 내림
    
---

## ⚙️ 환경 세팅 & 실행 방법

### 1. 사전 준비 

```bash
git clone https://github.com/MixupTeam4/Grammar-Error-Correction-Promptathon.git
```

### 라이브러리 설치

```bash
pip install -r requirements.txt
```

### 데이터 준비 / API KEY 준비

```bash
cd src
mkdir data  # data/test.csv 저장

```
+ API KEY는 src/main.py 내 API_KEYS에 저장
+ 병렬 처리 여부는 src/main.py의 parellel(bool) 값으로 결정

### 실험 실행

```bash
cd src
python main.py
```

---


## 🚧 실험의 한계 및 향후 개선

* **한계**:

  * 과교정 현상 : 동일 의미의 다른 단어로 변경하는 경우를 아예 배제하지 못함
  * 조사 추가 누락 : 말은 되지만 존재하지 않는 조사를 추가하는 것을 놓치는 경우가 존재 
  * 출력 형식 위반 : 존재하지 않았던 명사 간 쉼표를 잘 생성해내지 못함. 
  * 받침형 조사 줄임말 누락 : "이걸"이라는 말 대신 "이거"라고 생성하는 경우가 존재. 

* **향후 개선 방향**  : 2차 교정 도입

    - 1차 교정된 문장에 대한 재교정을 통해 과교정 현상에 대응
    - 1차 교정된 문장에 대한 재교정을 통해 누락하기 쉬운 명사 간 띄어쓰기에 대응

---

## 📂 폴더 구조

```
📁 src/
├── main.py             # 메인 실행 파일
├── requirements.txt    # 필요한 패키지 목록
├── prompt/             # 프롬프트 관련 함수들
│   ├── __init__.py     # prompt 패키지 초기화
│   ├── few_shot.py     # 예시 기반 few_shot 생성
│   └── prompt.py       # 시스템 프롬프트, messages 생성
├── inference/          # 추론/병렬처리 관련 함수들
│   ├── __init__.py     # inference 패키지 초기화
│   ├── chat.py         # 실험 실행 및 API 호출
│   └── run.py          # 평가 지표 계산
├── utils/              # 유틸리티 함수들
│   ├── __init__.py     # utils 패키지 초기화
│   └── save.py         # 파일 저장 함수
└── data/               # 데이터셋 저장
    └── test.csv        # 평가 대상 데이터


